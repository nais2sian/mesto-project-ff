(()=>{"use strict";function e(e,t,o,n,r){var c=document.querySelector("#card-template").content.querySelector(".places__item.card").cloneNode(!0),i=c.querySelector(".card__delete-button"),a=c.querySelector(".card__description"),u=a.querySelector(".likeCounter"),p=a.querySelector(".card__like-button"),s=c.querySelector(".card__image"),l=c.querySelector(".card__title");s.src=e.link,s.alt="Фотография: "+e.name,l.textContent=e.name,s.name=e.name,r===e.owner._id?i.addEventListener("click",(function(){t(c,e._id)})):i.style.display="none",p.addEventListener("click",(function(){o(p,e,u)})),function(e,t,o){e.likes.forEach((function(e){e._id===t&&o.classList.add("card__like-button_is-active")}))}(e,r,p);var d=e.likes.length;return u.textContent=d,s.addEventListener("click",(function(){n(s)})),c}function t(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",n)}function o(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",n)}function n(e){if("Escape"===e.key||27===e.key){var t=document.querySelector(".popup_is-opened");t&&o(t)}}function r(){return fetch("https://nomoreparties.co/v1/wff-cohort-12/users/me",{headers:{authorization:"63f0e1bd-551c-4a91-abdc-db7a53e874be"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.error("Error fetching data: ",e)}))}var c={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function i(e,t){e.querySelectorAll(t.inputSelector).forEach((function(e){e.classList.remove(t.inputErrorClass),e.setCustomValidity("");var o=e.nextElementSibling;o.classList.remove("popup__error_visible"),o.textContent=""}))}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var u,p=document.querySelector(".content"),s=document.querySelectorAll(".popup"),l=p.querySelector(".places.page__section").querySelector(".places__list"),d=p.querySelector(".profile.page__section"),_=d.querySelector(".profile__info"),f=d.querySelector(".profile__image"),y=_.querySelector(".profile__title"),h=_.querySelector(".profile__description"),m=_.querySelector(".profile__edit-button"),b=d.querySelector(".profile__add-button"),v=document.querySelector(".popup.popup_type_image"),S=v.querySelector(".popup__content.popup__content_content_image"),q=S.querySelector(".popup__image"),g=S.querySelector(".popup__caption"),E=document.querySelector(".popup.popup_type_edit"),k=E.querySelector(".popup__content").querySelector(".popup__form"),C=k.querySelector(".popup__input.popup__input_type_name"),L=k.querySelector(".popup__input.popup__input_type_description"),j=k.querySelector(".button.popup__button"),w=document.querySelector(".popup.popup_type_new-avatar"),x=w.querySelector(".popup__content").querySelector(".popup__form"),P=x.querySelector(".popup__input.popup__input_type_url"),A=x.querySelector(".button.popup__button"),T=document.querySelector(".popup.popup_type_new-card"),z=T.querySelector(".popup__content").querySelector(".popup__form"),O=z.querySelector(".button.popup__button"),F=z.querySelector(".popup__input.popup__input_type_card-name"),D=z.querySelector(".popup__input.popup__input_type_url");function I(e){t(v),q.src=e.src,q.alt=e.alt,g.textContent=e.name}function N(e,t){e.remove(),fetch("https://nomoreparties.co/v1/wff-cohort-12/cards/"+t,{method:"DELETE",headers:{authorization:"63f0e1bd-551c-4a91-abdc-db7a53e874be","Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(res.status))})).then((function(e){console.log("Profile updated:",e)})).catch((function(e){console.error("Failed to update profile:",e)}))}function M(e,t,o){e.classList.toggle("card__like-button_is-active");var n,r=t._id;e.classList.contains("card__like-button_is-active")?(o.textContent=parseInt(o.textContent)+1,(n=r,fetch("https://nomoreparties.co/v1/wff-cohort-12/cards/likes/"+n,{method:"PUT",headers:{authorization:"63f0e1bd-551c-4a91-abdc-db7a53e874be","Content-Type":"application/json"}}).then((function(e){if(!e.ok)throw new Error("Network response was not ok.");return e.json()})).then((function(e){return e})).catch((function(e){throw console.error("Failed to update like:",e),e}))).then((function(e){console.log("setLike data:",e)})).catch((function(e){throw console.error("Failed to update like:",e),e}))):(t.likes.length,function(e){return fetch("https://nomoreparties.co/v1/wff-cohort-12/cards/likes/"+e,{method:"DELETE",headers:{authorization:"63f0e1bd-551c-4a91-abdc-db7a53e874be","Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(res.status))}))}(r).then((function(e){console.log("Profile updated:",e),o.textContent=e.likes.length})).catch((function(e){console.error("Failed to update profile:",e)})))}Promise.all([r(),fetch("https://nomoreparties.co/v1/wff-cohort-12/cards",{headers:{authorization:"63f0e1bd-551c-4a91-abdc-db7a53e874be"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.error("Error fetching data: ",e)}))]).then((function(t){var o,n,r,c,i=(c=2,function(e){if(Array.isArray(e))return e}(r=t)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,c,i,a=[],u=!0,p=!1;try{if(c=(o=o.call(e)).next,0===t){if(Object(o)!==o)return;u=!1}else for(;!(u=(n=c.call(o)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(e){p=!0,r=e}finally{try{if(!u&&null!=o.return&&(i=o.return(),Object(i)!==i))return}finally{if(p)throw r}}return a}}(r,c)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?a(e,t):void 0}}(r,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=i[0];o=i[1],n=u._id,o.forEach((function(t){var o=e(t,N,M,I,n);l.append(o)}))})).catch((function(e){console.error("Error processing data: ",e)})),s.forEach((function(e){e.classList.add("popup_is-animated"),e.addEventListener("click",(function(e){!function(e){var t=e.target.classList.contains("popup__close"),n=e.target.classList.contains("popup"),r=document.querySelector(".popup_is-opened");(t||n)&&r&&o(r)}(e)}))})),b.addEventListener("click",(function(){t(T),O.classList.add("popup__button_disabled"),z.reset(),O.textContent="Сохранить",i(z,c)})),r().then((function(e){e&&function(e){y.textContent=e.name,h.textContent=e.about;var t=e.avatar;f.style.backgroundImage="url('".concat(t,"')")}(e)})).catch((function(e){console.error("Error handling data: ",e)})),m.addEventListener("click",(function(){t(E),j.textContent="Сохранить",i(E,c),C.value=y.textContent,L.value=h.textContent})),k.addEventListener("submit",(function(e){e.preventDefault();var t=C.value,n=L.value;(function(e,t){fetch("https://nomoreparties.co/v1/wff-cohort-12/users/me",{method:"PATCH",headers:{authorization:"63f0e1bd-551c-4a91-abdc-db7a53e874be","Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(res.status))})).then((function(e){console.log("Profile updated:",e)})).catch((function(e){console.error("Failed to update profile:",e)}))})(t,n),j.textContent="Сохранение...",y.textContent=t,h.textContent=n,o(E)})),T.addEventListener("submit",(function(t){t.preventDefault(),function(e,t){return fetch("https://nomoreparties.co/v1/wff-cohort-12/cards",{method:"POST",headers:{authorization:"63f0e1bd-551c-4a91-abdc-db7a53e874be","Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(res.status))}))}(F.value,D.value).then((function(t){console.log("Profile updated:",t);var o=e(t,N,M,I,t.owner._id);l.prepend(o)})).catch((function(e){console.error("Failed to update profile:",e)})),O.textContent="Сохранение...",z.reset(),o(T)})),f.addEventListener("click",(function(){t(w),A.classList.add("popup__button_disabled"),x.reset(),A.textContent="Сохранить"})),w.addEventListener("submit",(function(e){var t;e.preventDefault(),(t=P.value,fetch("https://nomoreparties.co/v1/wff-cohort-12/users/me/avatar",{method:"PATCH",headers:{authorization:"63f0e1bd-551c-4a91-abdc-db7a53e874be","Content-Type":"application/json"},body:JSON.stringify({avatar:t})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(res.status))}))).then((function(e){console.log("Profile updated:",e);var t=e.avatar;f.style.backgroundImage="url('".concat(t,"')")})).catch((function(e){console.error("Failed to update profile:",e)})),A.textContent="Сохранение...",o(w),x.reset()})),document.querySelectorAll(".popup__form").forEach((function(e){!function(e,t){t.querySelectorAll(e.inputSelector).forEach((function(e){e.addEventListener("input",(function(){var t,o;"url"!==e.id&&(o=(t=e).nextElementSibling,t.validity.patternMismatch?(t.setCustomValidity(t.dataset.errorMessage),o.textContent=t.validationMessage,t.classList.add("popup__input_type_error"),o.classList.add("popup__error_visible")):(t.classList.remove("popup__input_type_error"),o.classList.remove("popup__error_visible"),o.textContent="",t.setCustomValidity("")))}))})),t.addEventListener("submit",(function(e){e.preventDefault()}))}(c,e)})),u=c,document.querySelectorAll(".popup__form").forEach((function(e){var t=Array.from(e.querySelectorAll(u.inputSelector)),o=e.querySelector(u.submitButtonSelector);t.forEach((function(e){e.addEventListener("input",(function(){!function(e,t){console.log(e),!0===e.some((function(e){return!e.validity.valid}))?(console.log("не валидно"),t.classList.add("popup__button_disabled")):(console.log("валидно"),t.classList.remove("popup__button_disabled"))}(t,o)}))}))}))})();
//# sourceMappingURL=main.js.map